use soroban_sdk::{contract, contracterror, contractevent, contractimpl, contracttype, vec, Address, Bytes, Env, Vec, U256, symbol_short};

#[contracttype]
#[derive(Clone, Debug)]
enum DataKey {
    Admin,
    FilledSubtrees(u32),
    Zeroes(u32),
    Levels,
    NextIndex,
    Root,
}

// Errors
#[contracterror]
#[derive(Copy, Clone, Debug, Eq, PartialEq, PartialOrd, Ord)]
#[repr(u32)]
pub enum Error {
    NotAuthorized = 1,
    MerkleTreeFull = 2,
}

// Events
#[contractevent(topics = ["LeafAdded"])]
struct LeafAddedEvent {
    leaf: U256,   // Inserted leaf
    index: u32,   // Index where the leaf was inserted
    root: U256,   // Updated root after insertion
}

#[contract]
pub struct ASPMembership;

#[contractimpl]
impl ASPMembership {
    pub fn init(env: Env, admin: Address, levels: u32)  {
        if levels == 0 || levels > 32 {
            panic!("Levels must be within the range [1..32]");
        }
        
        let store = env.storage().persistent();
        // Initialize
        store.set(&DataKey::Admin, &admin);
        store.set(&DataKey::Levels, &levels);
        store.set(&DataKey::NextIndex, &0u32);
        // Initialize an empty tree (and subtrees)
        let zeros: Vec<U256> = Self::get_zeroes(&env);
        for lvl in 0..levels + 1 {
            let zero_val = zeros.get(lvl).unwrap();
            store.set(&DataKey::FilledSubtrees(lvl), &zero_val);  
        }
        // Set root
        let root_val = zeros.get(levels).unwrap();
        store.set(&DataKey::Root, &root_val);
    }

    pub fn update_admin(env: Env, admin: Address, new_admin: Address) {
        // Enforce only the admin can call the update_admin function
        admin.require_auth();
        let store = env.storage().persistent();
        // Update admin
        store.set(&DataKey::Admin, &new_admin);
    }
    
    pub fn hash_pair(env: &Env, left: U256, right: U256) -> U256 {
        // TODO: Check inputs are within field range
        let bn256_mod = U256::from_be_bytes(env, &Bytes::from_array(env, &[48, 100, 78, 114, 225, 49, 160, 41, 184, 80, 69, 182, 129, 129, 88, 93, 40, 51, 232, 72, 121, 185, 112, 145, 67, 225, 245, 147, 240, 0, 0, 1]));
        if left >= bn256_mod || right >= bn256_mod {
            panic!("Hash inputs must be within the BN256 range [0.p-1)");
        }
        // Constants
        let crypto_hazmat = env.crypto_hazmat();
        let round_constants = &vec![
            env,
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env,&[9, 196, 110, 158, 198, 142, 155, 212, 254, 31, 170, 186, 41, 76, 186, 56, 167, 26, 161, 119, 83, 76, 221, 27, 108, 125, 192, 219, 208, 171, 215, 167])),
                 U256::from_be_bytes(env, &Bytes::from_array(env,&[12, 3, 86, 83, 8, 150, 238, 196, 42, 151, 237, 147, 127, 49, 53, 207, 197, 20, 43, 58, 228, 5, 184, 52, 60, 29, 131, 255, 166, 4, 203, 129]))],             
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[30, 40, 161, 217, 53, 105, 138, 209, 20, 46, 81, 24, 43, 181, 76, 244, 160, 14, 165, 170, 189, 98, 104, 189, 49, 126, 169, 119, 204, 21, 74, 48])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[39, 175, 45, 131, 26, 157, 39, 72, 8, 9, 101, 219, 48, 226, 152, 228, 14, 87, 87, 195, 224, 8, 219, 150, 76, 249, 226, 177, 43, 145, 37, 31]))],             
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[30, 111, 17, 206, 96, 252, 143, 81, 58, 106, 60, 254, 22, 174, 23, 90, 65, 41, 20, 98, 242, 20, 205, 8, 121, 170, 244, 53, 69, 183, 78, 3])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[42, 103, 56, 77, 59, 189, 94, 67, 133, 65, 129, 156, 182, 129, 240, 190, 4, 70, 46, 209, 76, 54, 19, 216, 247, 25, 32, 98, 104, 209, 66, 211]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[11, 102, 253, 243, 86, 9, 58, 97, 22, 9, 248, 225, 47, 191, 236, 240, 185, 133, 227, 129, 240, 37, 24, 137, 54, 64, 143, 93, 92, 159, 69, 208])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[1, 46, 227, 236, 30, 120, 212, 112, 131, 12, 97, 9, 60, 42, 222, 55, 11, 38, 200, 60, 197, 206, 190, 237, 218, 166, 133, 45, 189, 176, 158, 33]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[2, 82, 186, 95, 103, 96, 191, 189, 253, 136, 246, 127, 129, 117, 227, 253, 108, 209, 196, 49, 176, 153, 182, 187, 45, 16, 142, 123, 68, 91, 177, 185])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[23, 148, 116, 204, 236, 165, 255, 103, 108, 107, 236, 60, 239, 84, 41, 99, 84, 57, 26, 137, 53, 255, 113, 214, 239, 90, 234, 173, 124, 169, 50, 241])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[44, 36, 38, 19, 121, 165, 27, 250, 146, 40, 255, 74, 80, 63, 212, 237, 156, 31, 151, 74, 38, 73, 105, 179, 126, 26, 37, 137, 187, 237, 43, 145])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[28, 193, 215, 182, 38, 146, 230, 62, 172, 47, 40, 139, 208, 105, 91, 67, 194, 246, 63, 80, 1, 252, 15, 197, 83, 230, 108, 5, 81, 128, 27, 5])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[37, 80, 89, 48, 26, 173, 169, 139, 178, 237, 85, 248, 82, 151, 158, 150, 0, 120, 77, 191, 23, 251, 172, 208, 93, 158, 255, 95, 217, 201, 27, 86])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[40, 67, 123, 227, 172, 28, 178, 228, 121, 225, 245, 192, 236, 205, 50, 179, 174, 162, 66, 52, 151, 10, 129, 147, 177, 28, 41, 206, 126, 89, 239, 217])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[40, 33, 106, 68, 47, 46, 31, 113, 28, 164, 250, 107, 83, 118, 110, 177, 24, 84, 141, 168, 251, 79, 120, 212, 51, 135, 98, 195, 127, 95, 32, 67])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[44, 31, 71, 205, 23, 250, 90, 223, 31, 57, 244, 231, 5, 109, 208, 63, 238, 225, 239, 206, 3, 9, 69, 129, 19, 31, 35, 119, 50, 52, 130, 201])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[7, 171, 173, 2, 183, 165, 235, 196, 134, 50, 188, 201, 53, 108, 235, 125, 217, 218, 252, 162, 118, 99, 138, 99, 100, 107, 133, 102, 166, 33, 175, 201])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[2, 48, 38, 70, 1, 255, 223, 41, 39, 91, 51, 255, 170, 181, 29, 254, 148, 41, 249, 8, 128, 166, 156, 209, 55, 218, 12, 77, 21, 249, 108, 60])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[27, 201, 115, 5, 78, 81, 217, 5, 160, 241, 104, 101, 100, 151, 202, 64, 168, 100, 65, 69, 87, 238, 40, 158, 113, 126, 93, 102, 137, 154, 160, 169])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[46, 28, 34, 249, 100, 67, 80, 8, 32, 108, 49, 87, 232, 99, 65, 237, 210, 73, 175, 245, 194, 216, 66, 31, 42, 107, 34, 40, 143, 10, 103, 252])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[18, 36, 243, 141, 246, 124, 83, 120, 18, 28, 29, 95, 70, 27, 188, 80, 158, 142, 161, 89, 142, 70, 201, 247, 167, 4, 82, 188, 43, 186, 134, 184])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[2, 228, 230, 157, 139, 165, 158, 81, 146, 128, 180, 189, 158, 208, 6, 143, 215, 191, 232, 205, 157, 254, 218, 25, 105, 210, 152, 145, 134, 205, 226, 14])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[31, 30, 204, 195, 74, 171, 160, 19, 127, 93, 248, 31, 192, 79, 243, 238, 79, 25, 238, 54, 78, 101, 63, 7, 109, 71, 233, 115, 93, 152, 1, 142])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[22, 114, 173, 61, 112, 154, 53, 57, 116, 38, 108, 48, 57, 169, 167, 49, 20, 36, 68, 128, 50, 205, 24, 25, 234, 203, 138, 77, 66, 132, 245, 130])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[40, 62, 63, 220, 44, 110, 66, 12, 86, 244, 74, 245, 25, 43, 74, 233, 205, 166, 150, 31, 40, 77, 36, 153, 29, 46, 214, 2, 223, 140, 143, 199])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[28, 42, 61, 18, 12, 85, 14, 207, 208, 219, 9, 87, 23, 15, 160, 19, 104, 55, 81, 248, 253, 255, 89, 214, 97, 79, 189, 105, 255, 57, 75, 204])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[33, 111, 132, 135, 122, 172, 97, 114, 247, 137, 122, 115, 35, 69, 110, 254, 20, 58, 154, 67, 119, 62, 166, 242, 150, 203, 107, 129, 119, 101, 63, 189])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[44, 13, 39, 43, 236, 242, 167, 87, 100, 186, 126, 142, 62, 40, 209, 43, 206, 170, 71, 234, 97, 202, 89, 164, 17, 161, 245, 21, 82, 249, 71, 136])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[22, 227, 66, 153, 134, 92, 14, 40, 72, 78, 231, 167, 76, 69, 78, 159, 23, 10, 84, 128, 171, 224, 80, 143, 203, 74, 108, 61, 137, 84, 111, 67])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[23, 92, 235, 165, 153, 233, 111, 91, 55, 90, 35, 42, 111, 185, 204, 113, 119, 32, 71, 118, 88, 2, 41, 15, 72, 205, 147, 151, 85, 72, 143, 197])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[12, 117, 148, 68, 13, 196, 140, 22, 254, 173, 158, 23, 88, 176, 40, 6, 106, 164, 16, 191, 188, 53, 79, 84, 216, 197, 255, 187, 68, 161, 238, 50])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[26, 60, 41, 188, 57, 242, 27, 181, 196, 102, 219, 125, 126, 182, 253, 143, 118, 14, 32, 1, 60, 207, 145, 44, 146, 71, 152, 130, 217, 25, 253, 141])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[12, 207, 221, 144, 111, 52, 38, 229, 192, 152, 110, 160, 73, 178, 83, 64, 8, 85, 211, 73, 7, 79, 90, 102, 149, 200, 238, 171, 205, 34, 230, 143])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[20, 246, 188, 129, 217, 241, 134, 246, 43, 219, 71, 92, 230, 201, 65, 24, 102, 167, 168, 163, 253, 6, 91, 60, 224, 230, 153, 182, 125, 217, 231, 150])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[9, 98, 184, 39, 137, 251, 61, 18, 151, 2, 202, 112, 178, 246, 197, 170, 204, 9, 152, 16, 201, 196, 149, 200, 136, 237, 235, 115, 134, 185, 112, 82])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[26, 136, 10, 247, 7, 77, 24, 179, 191, 32, 199, 157, 226, 81, 39, 188, 19, 40, 74, 176, 30, 240, 37, 117, 175, 239, 12, 143, 106, 49, 168, 109])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[16, 203, 161, 132, 25, 166, 163, 50, 205, 94, 119, 240, 33, 28, 21, 75, 32, 175, 41, 36, 252, 32, 255, 63, 76, 48, 18, 187, 122, 233, 49, 27])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[5, 126, 98, 169, 168, 248, 155, 62, 189, 199, 107, 166, 58, 158, 172, 168, 250, 39, 183, 49, 156, 174, 52, 6, 117, 106, 40, 73, 243, 2, 241, 13])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[40, 124, 151, 29, 233, 29, 192, 171, 212, 74, 223, 83, 132, 180, 152, 140, 185, 97, 48, 59, 191, 101, 207, 245, 175, 160, 65, 59, 68, 40, 12, 238])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[33, 223, 51, 136, 175, 22, 135, 187, 179, 188, 169, 218, 12, 202, 144, 143, 30, 86, 43, 196, 109, 74, 186, 78, 111, 127, 121, 96, 227, 6, 137, 29])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[27, 229, 200, 135, 210, 91, 206, 112, 62, 37, 204, 151, 77, 9, 52, 205, 120, 157, 248, 247, 11, 73, 143, 216, 62, 255, 139, 86, 14, 22, 130, 179])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[38, 141, 163, 111, 118, 229, 104, 251, 104, 17, 113, 117, 206, 162, 205, 13, 210, 203, 93, 66, 253, 165, 172, 234, 72, 213, 156, 39, 6, 160, 213, 193])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[14, 23, 171, 9, 31, 110, 174, 80, 198, 9, 190, 175, 85, 16, 236, 236, 197, 216, 187, 116, 19, 94, 189, 5, 189, 6, 70, 12, 194, 106, 94, 214])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[4, 215, 39, 231, 40, 255, 160, 166, 122, 238, 83, 90, 176, 116, 164, 48, 145, 239, 98, 216, 207, 131, 210, 112, 4, 15, 92, 170, 31, 98, 175, 64])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[13, 219, 215, 191, 156, 41, 52, 21, 129, 181, 73, 118, 43, 192, 34, 237, 51, 112, 42, 193, 15, 27, 253, 134, 43, 21, 65, 125, 126, 57, 202, 110])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[39, 144, 235, 51, 81, 98, 23, 82, 118, 129, 98, 232, 41, 137, 198, 194, 52, 245, 176, 209, 211, 175, 155, 88, 138, 41, 196, 156, 135, 137, 101, 75])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[30, 69, 124, 96, 26, 99, 183, 62, 68, 113, 149, 1, 147, 216, 165, 112, 57, 95, 61, 154, 184, 178, 253, 9, 132, 183, 100, 32, 97, 66, 249, 233])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[33, 174, 100, 48, 29, 202, 150, 37, 99, 141, 106, 178, 187, 231, 19, 95, 250, 144, 236, 208, 196, 63, 249, 31, 196, 198, 134, 252, 70, 224, 145, 176])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[3, 121, 246, 60, 140, 227, 70, 141, 77, 162, 147, 22, 111, 73, 73, 40, 133, 75, 233, 227, 67, 46, 9, 85, 88, 88, 83, 78, 237, 141, 53, 11])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 45, 86, 66, 3, 89, 208, 38, 106, 116, 74, 8, 8, 9, 224, 84, 202, 14, 73, 33, 164, 102, 134, 172, 140, 159, 88, 163, 36, 195, 80, 73])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[18, 49, 88, 229, 150, 91, 93, 155, 29, 104, 179, 205, 50, 225, 11, 190, 218, 141, 98, 69, 158, 33, 244, 9, 15, 194, 197, 175, 150, 53, 21, 166])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[11, 226, 159, 196, 8, 71, 169, 65, 102, 29, 20, 187, 246, 203, 224, 66, 15, 187, 43, 111, 82, 131, 109, 78, 96, 200, 14, 180, 156, 173, 158, 193])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[26, 201, 105, 145, 222, 194, 187, 5, 87, 113, 97, 66, 1, 90, 69, 60, 54, 219, 157, 133, 156, 173, 95, 154, 35, 56, 2, 242, 79, 223, 76, 26])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[21, 150, 68, 63, 118, 61, 188, 194, 95, 73, 100, 252, 97, 210, 59, 62, 94, 18, 201, 250, 151, 241, 138, 146, 81, 202, 51, 85, 188, 176, 98, 126])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[18, 224, 188, 211, 101, 75, 223, 167, 107, 40, 97, 212, 236, 58, 234, 224, 241, 133, 125, 159, 23, 231, 21, 174, 214, 208, 73, 234, 227, 186, 50, 18])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[15, 201, 43, 79, 27, 190, 168, 43, 158, 167, 61, 74, 249, 175, 42, 80, 206, 171, 172, 127, 55, 21, 75, 25, 4, 230, 199, 108, 124, 249, 100, 186])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[31, 156, 11, 22, 16, 68, 100, 66, 214, 242, 229, 146, 168, 1, 63, 64, 177, 79, 124, 119, 34, 35, 111, 79, 156, 126, 150, 82, 51, 135, 39, 98])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[14, 189, 116, 36, 74, 231, 38, 117, 248, 205, 224, 97, 87, 167, 130, 244, 5, 13, 145, 77, 163, 139, 76, 5, 141, 21, 159, 100, 61, 187, 244, 211])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[44, 183, 240, 237, 57, 225, 110, 159, 105, 169, 250, 253, 74, 185, 81, 192, 59, 6, 113, 233, 115, 70, 238, 57, 122, 131, 152, 57, 220, 207, 198, 209])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[26, 157, 110, 46, 207, 240, 34, 204, 86, 5, 68, 62, 228, 27, 171, 32, 206, 118, 29, 5, 20, 206, 82, 102, 144, 199, 43, 202, 115, 82, 217, 191])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[42, 17, 84, 57, 96, 127, 51, 90, 94, 168, 60, 59, 196, 74, 147, 49, 208, 193, 51, 38, 169, 167, 186, 48, 135, 218, 24, 45, 100, 142, 199, 47])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[35, 249, 182, 82, 155, 93, 4, 13, 21, 184, 250, 122, 238, 62, 52, 16, 231, 56, 181, 99, 5, 205, 68, 242, 149, 53, 193, 21, 197, 164, 192, 96])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[5, 135, 44, 22, 219, 15, 114, 162, 36, 154, 198, 186, 72, 75, 185, 195, 163, 206, 151, 193, 109, 88, 182, 139, 38, 14, 185, 57, 240, 230, 232, 167])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[19, 0, 189, 238, 8, 187, 120, 36, 202, 32, 251, 128, 17, 128, 117, 244, 2, 25, 182, 21, 29, 85, 181, 197, 43, 98, 74, 124, 222, 221, 246, 167])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[25, 185, 182, 61, 47, 16, 142, 23, 230, 56, 23, 134, 58, 143, 108, 40, 141, 122, 210, 153, 22, 217, 140, 177, 7, 46, 78, 123, 125, 82, 179, 118])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[1, 91, 238, 19, 87, 227, 192, 21, 181, 189, 162, 55, 102, 133, 34, 246, 19, 209, 200, 135, 38, 181, 236, 66, 36, 162, 1, 40, 72, 27, 79, 127]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[41, 83, 115, 110, 148, 187, 107, 159, 27, 151, 7, 164, 241, 97, 94, 78, 254, 30, 28, 228, 186, 178, 24, 203, 234, 146, 199, 133, 177, 40, 255, 209])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[11, 6, 147, 83, 186, 9, 22, 24, 134, 47, 128, 97, 128, 192, 56, 95, 133, 27, 152, 211, 114, 180, 95, 84, 76, 231, 38, 110, 214, 96, 141, 252]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[48, 79, 116, 212, 97, 204, 193, 49, 21, 228, 224, 188, 251, 147, 129, 126, 85, 174, 183, 235, 147, 6, 182, 78, 79, 88, 138, 201, 125, 129, 244, 41])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[21, 187, 241, 70, 206, 155, 202, 9, 232, 163, 63, 94, 119, 223, 228, 245, 170, 210, 161, 100, 164, 97, 122, 76, 184, 238, 84, 21, 205, 233, 19, 252]))],
                vec![env, U256::from_be_bytes(env, &Bytes::from_array(env, &[10, 180, 223, 224, 194, 116, 44, 222, 68, 144, 16, 49, 72, 121, 100, 237, 155, 143, 75, 133, 4, 5, 193, 12, 169, 255, 35, 133, 149, 114, 200, 198])),
                U256::from_be_bytes(env, &Bytes::from_array(env, &[14, 50, 219, 50, 10, 4, 78, 49, 151, 244, 95, 118, 73, 161, 150, 117, 239, 94, 237, 254, 165, 70, 222, 169, 37, 29, 227, 159, 150, 57, 119, 154]))],
        ];
        
        // Permutation and compression
        let out = crypto_hazmat.poseidon2_permutation(
            &vec![env, left.clone(), right.clone()],
            symbol_short!("BN254"), 
            2,
            5,
            8,
            56,
            &vec![env, U256::from_u32(env,1u32), U256::from_u32(env, 2u32)],
            round_constants
        );
        
        // Compression step: we get elements from the output vector and add the inputs
        let out_0 = out.get(0).unwrap();
        let out_1 = out.get(1).unwrap();
        let mut compressed_0 = out_0.add(&left);
        if compressed_0 >= bn256_mod {
            compressed_0 = compressed_0.rem_euclid(&bn256_mod);
        }
        let mut _compressed_1 = out_1.add(&right);
        if _compressed_1 >= bn256_mod {
            _compressed_1 = _compressed_1.rem_euclid(&bn256_mod);
        }
        // By default, we truncate to the first element
        compressed_0
    }

    pub fn insert_leaf(env: Env, admin: Address, leaf: U256) -> Result<(), Error> {
        // Enforce only the admin can call the insert_leaf function
        admin.require_auth();
        let store = env.storage().persistent();
        let levels: u32 = store.get(&DataKey::Levels).unwrap();
        let actual_index: u32 = store.get(&DataKey::NextIndex).unwrap();
        let mut current_index = actual_index;
        
        if current_index >= (1 << levels) { // Limit: 2^levels leaves
            Err(Error::MerkleTreeFull)
        } else {
            let mut current_hash = leaf.clone();
            let zeros = Self::get_zeroes(&env);
            for lvl in 0..levels {
                // Check if the leaf is a right (or left) child
                let is_right = current_index & 1 == 1;
                if is_right {
                    let left: U256 = store.get(&DataKey::FilledSubtrees(lvl)).unwrap();
                    current_hash = Self::hash_pair(&env, left, current_hash);
                } else {
                    // We store the filled subtree at the current level with the current hash
                    store.set(&DataKey::FilledSubtrees(lvl), &current_hash);
                    let zero_val = zeros.get(lvl).unwrap();
                    current_hash = Self::hash_pair(&env, current_hash, zero_val);
                }
                // Divide the index by 2 to move up in the tree
                current_index >>= 1;
            }
            
            // Update the root with the final hash
            store.set(&DataKey::Root, &current_hash);
            
            // Emit event
            LeafAddedEvent {
                leaf: leaf.clone(),
                index: store.get(&DataKey::NextIndex).unwrap(),
                root: current_hash,
            }.publish(&env);
            
            // Update NextIndex
            store.set(&DataKey::NextIndex, &(actual_index + 1));
            Ok(())
        }
    }
    
    pub fn get_zeroes(env: &Env) -> Vec<U256> {
        // Hash of 0 at the leaf level is defined as Poseidon2 hash of "XLM" encoded as ASCII.
        // More specifically, t=4, r=3, domain_sep=0. poseidon2(88, 76,77) = poseidon2("XLM").
        // From there, we use the poseidon2 compression function to get the zero hash for each level
        // Big Endian bytes
        let zeros = vec![
            env,
            U256::from_be_bytes(env, &Bytes::from_array(env,&[37, 48, 34, 136, 219, 153, 53, 3, 68, 151, 65, 131, 206, 49, 13, 99, 181, 58, 187, 158, 240, 248, 87, 87, 83, 238, 211, 110, 1, 24, 249, 206])),          // 0
            U256::from_be_bytes(env, &Bytes::from_array(env,&[33, 244, 234, 36, 146, 173, 224, 6, 168, 238, 127, 183, 100, 6, 10, 149, 164, 238, 245, 202, 147, 30, 3, 123, 205, 240, 95, 194, 128, 103, 208, 8])),     // 1
            U256::from_be_bytes(env, &Bytes::from_array(env,&[14, 191, 180, 210, 240, 91, 182, 164, 115, 201, 191, 247, 37, 134, 254, 200, 6, 241, 172, 35, 112, 21, 197, 112, 215, 199, 130, 73, 207, 125, 119, 64])), // 2
            U256::from_be_bytes(env, &Bytes::from_array(env,&[6, 104, 130, 165, 218, 177, 134, 212, 214, 63, 166, 96, 15, 158, 163, 213, 205, 254, 242, 162, 129, 28, 137, 115, 17, 40, 167, 41, 215, 232, 184, 151])),   // 3
            U256::from_be_bytes(env, &Bytes::from_array(env,&[6, 93, 179, 20, 141, 141, 165, 50, 155, 234, 236, 80, 66, 120, 92, 105, 242, 206, 7, 9, 226, 109, 70, 139, 218, 30, 37, 92, 89, 155, 86, 134])),          // 4
            U256::from_be_bytes(env, &Bytes::from_array(env,&[25, 146, 111, 170, 35, 176, 115, 125, 70, 127, 148, 118, 240, 248, 75, 41, 104, 255, 102, 102, 225, 106, 35, 228, 212, 72, 152, 248, 132, 80, 71, 100])), // 5
            U256::from_be_bytes(env, &Bytes::from_array(env,&[40, 124, 72, 90, 114, 204, 200, 212, 216, 6, 146, 217, 126, 182, 44, 22, 73, 83, 160, 66, 39, 145, 246, 175, 98, 20, 169, 167, 173, 34, 121, 192])),      // 6
            U256::from_be_bytes(env, &Bytes::from_array(env,&[31, 114, 158, 16, 62, 125, 65, 95, 114, 141, 201, 69, 227, 182, 226, 196, 10, 192, 203, 54, 158, 83, 43, 165, 10, 86, 151, 144, 205, 222, 42, 204])),     // 7
            U256::from_be_bytes(env, &Bytes::from_array(env,&[24, 135, 231, 31, 146, 33, 127, 254, 134, 98, 14, 110, 165, 167, 26, 211, 82, 31, 173, 228, 200, 50, 3, 255, 163, 232, 56, 254, 61, 110, 114, 3])),       // 8
            U256::from_be_bytes(env, &Bytes::from_array(env,&[41, 90, 167, 142, 86, 199, 160, 154, 134, 79, 47, 65, 117, 16, 0, 149, 243, 231, 185, 239, 42, 145, 26, 248, 124, 176, 243, 247, 238, 242, 119, 0])),       // 9
            U256::from_be_bytes(env, &Bytes::from_array(env,&[5, 23, 3, 42, 121, 107, 3, 64, 220, 95, 157, 242, 139, 31, 211, 32, 218, 186, 36, 213, 164, 83, 53, 161, 55, 22, 115, 0, 238, 54, 136, 40])),             // 10
            U256::from_be_bytes(env, &Bytes::from_array(env,&[21, 250, 223, 73, 71, 210, 164, 12, 123, 67, 158, 131, 234, 60, 151, 159, 247, 37, 170, 209, 28, 71, 170, 175, 137, 42, 171, 65, 61, 178, 220, 221])),    // 11
            U256::from_be_bytes(env, &Bytes::from_array(env,&[0, 172, 183, 35, 107, 109, 135, 244, 135, 91, 59, 157, 23, 32, 169, 224, 104, 44, 112, 228, 188, 109, 84, 237, 246, 31, 170, 43, 201, 56, 65, 214])),     // 12
            U256::from_be_bytes(env, &Bytes::from_array(env,&[9, 131, 109, 217, 5, 77, 86, 10, 230, 14, 166, 168, 3, 52, 4, 179, 228, 3, 9, 246, 238, 77, 23, 10, 203, 146, 230, 102, 126, 134, 199, 117])),            // 13
            U256::from_be_bytes(env, &Bytes::from_array(env,&[33, 152, 148, 107, 23, 249, 186, 3, 93, 126, 231, 40, 116, 28, 165, 244, 229, 135, 92, 182, 175, 178, 150, 132, 166, 245, 249, 168, 47, 238, 196, 130])), // 14
            U256::from_be_bytes(env, &Bytes::from_array(env,&[21, 212, 177, 104, 48, 96, 77, 190, 11, 50, 18, 227, 31, 149, 116, 120, 124, 21, 176, 245, 78, 94, 36, 176, 128, 104, 126, 122, 110, 246, 212, 85])),       // 15
            U256::from_be_bytes(env, &Bytes::from_array(env,&[45, 7, 247, 62, 4, 207, 10, 83, 128, 55, 186, 7, 86, 22, 81, 172, 151, 155, 176, 14, 23, 5, 199, 93, 220, 149, 22, 236, 75, 138, 106, 118])),             // 16
            U256::from_be_bytes(env, &Bytes::from_array(env,&[2, 248, 115, 26, 234, 40, 154, 107, 64, 16, 0, 72, 126, 140, 105, 37, 201, 34, 64, 126, 236, 165, 143, 46, 24, 204, 138, 217, 182, 197, 209, 63])),       // 17
            U256::from_be_bytes(env, &Bytes::from_array(env,&[10, 48, 5, 60, 23, 135, 199, 151, 130, 230, 11, 200, 216, 37, 233, 227, 35, 200, 169, 2, 249, 58, 165, 146, 60, 36, 209, 125, 22, 219, 146, 92])),        // 18
            U256::from_be_bytes(env, &Bytes::from_array(env,&[14, 163, 5, 141, 153, 88, 186, 95, 228, 65, 251, 215, 157, 201, 104, 244, 73, 33, 93, 222, 230, 97, 70, 22, 26, 252, 243, 76, 52, 191, 164, 144])),       // 19
            U256::from_be_bytes(env, &Bytes::from_array(env,&[39, 185, 147, 126, 71, 166, 89, 131, 173, 80, 165, 183, 246, 185, 207, 5, 66, 201, 26, 141, 250, 23, 20, 206, 248, 144, 19, 67, 138, 6, 249, 183])),      // 20
            U256::from_be_bytes(env, &Bytes::from_array(env,&[45, 52, 123, 228, 229, 71, 197, 131, 124, 27, 33, 114, 50, 38, 40, 160, 196, 141, 102, 129, 147, 25, 103, 145, 179, 16, 103, 75, 4, 83, 192, 57])),       // 21
            U256::from_be_bytes(env, &Bytes::from_array(env,&[3, 242, 70, 27, 53, 184, 146, 252, 140, 88, 151, 6, 40, 61, 16, 131, 244, 210, 214, 107, 228, 249, 126, 70, 26, 186, 242, 240, 111, 137, 207, 253])),     // 22
            U256::from_be_bytes(env, &Bytes::from_array(env,&[37, 155, 143, 160, 8, 44, 246, 6, 111, 0, 90, 10, 73, 0, 103, 18, 254, 29, 207, 239, 106, 152, 214, 143, 122, 180, 69, 248, 138, 219, 97, 167])),         // 23
            U256::from_be_bytes(env, &Bytes::from_array(env,&[25, 128, 165, 247, 234, 192, 157, 170, 199, 178, 210, 23, 155, 161, 217, 112, 251, 63, 2, 19, 221, 144, 97, 49, 40, 245, 213, 88, 99, 216, 68, 20])),     // 24
            U256::from_be_bytes(env, &Bytes::from_array(env,&[28, 252, 217, 74, 171, 194, 60, 172, 212, 204, 171, 34, 232, 125, 35, 3, 32, 13, 9, 176, 48, 66, 178, 4, 127, 3, 210, 224, 222, 245, 126, 133])),         // 25
            U256::from_be_bytes(env, &Bytes::from_array(env,&[16, 43, 220, 129, 172, 191, 140, 82, 211, 88, 113, 162, 31, 242, 117, 22, 221, 190, 110, 49, 239, 81, 116, 12, 73, 189, 46, 226, 177, 152, 12, 33])),     // 26
            U256::from_be_bytes(env, &Bytes::from_array(env,&[47, 173, 132, 243, 136, 162, 99, 231, 20, 199, 179, 159, 176, 221, 36, 190, 97, 88, 185, 226, 20, 128, 170, 58, 96, 119, 135, 7, 136, 159, 118, 173])),     // 27
            U256::from_be_bytes(env, &Bytes::from_array(env,&[42, 206, 148, 45, 48, 190, 203, 54, 159, 28, 253, 2, 91, 83, 148, 214, 238, 76, 151, 245, 89, 48, 4, 138, 24, 251, 80, 17, 40, 200, 119, 119])),          // 28
            U256::from_be_bytes(env, &Bytes::from_array(env,&[9, 48, 254, 204, 191, 118, 42, 107, 35, 154, 206, 226, 195, 105, 222, 154, 49, 189, 62, 35, 44, 144, 198, 74, 241, 65, 148, 92, 28, 65, 84, 99])),        // 29
            U256::from_be_bytes(env, &Bytes::from_array(env,&[26, 89, 226, 186, 85, 241, 232, 41, 188, 162, 198, 49, 106, 156, 205, 8, 1, 125, 46, 155, 245, 50, 148, 44, 38, 216, 35, 101, 202, 96, 75, 88])),         // 30
            U256::from_be_bytes(env, &Bytes::from_array(env,&[26, 142, 132, 12, 132, 226, 251, 82, 18, 214, 31, 9, 173, 95, 145, 214, 167, 10, 131, 7, 78, 148, 39, 114, 239, 116, 180, 45, 18, 161, 31, 80])),         // 31
            U256::from_be_bytes(env, &Bytes::from_array(env,&[19, 75, 80, 223, 2, 226, 204, 185, 139, 89, 175, 44, 44, 85, 215, 164, 31, 241, 2, 104, 23, 48, 196, 43, 163, 100, 219, 255, 18, 113, 207, 98])),         // 32 - Root (when levels=32)
        ];
        zeros
    }
}

mod test;
